<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprite_parado</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-4</depth>
  <persistent>0</persistent>
  <parentName>obj_test</parentName>
  <maskName>sprite_parado</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Iniciadores
pupupa=0;
nombre=script_lan(0)
image_speed=0;
enum ej {parado=Prota_Parado,caminando=Prota_Caminando,morido=Prota_Muerto,
danado=Prota_Danado,saltado=Prota_Saltando,caido=Prota_Caida,cayendo=Prota_Cayendo,
espadazo=Prota_Espada,dash=Prota_Dash,pared=Prota_Pared}
instance_create(x,y,Camara);
instance_create(x,y,mira);
instance_create(x,y,obj_iluminacion);
instance_create(x,y,personaje_hud);
instance_create(0,0,obj_mapas);
if room=Central_1 and global.onirico=false{global.temax=tema_adonde2;global.onirico=true}
gamepad_set_vibration(0, 0, 0);
//if instance_exists(colztrok_2){global.temax=tema_intro_final;global.onirico=true}

hsp=0;
vsp=0;
global.direperx=x;
global.direpery=y;
ptf=1;
reinicio="no"
choizq=false;
choder=false;
blanca=false;
grav=0;
suelo=2;
salto=0;
lateral=0;
lateraba=false;
latersig=false;
platados=false;
difplatafor=0;
logrado="";
gravito=0;
congrav=0;
des=0;
veloc=0;
dandan=false;
press=false;
iner=0;
estcero=true;
inerval=0.5;
dash=false;
xcon=0;
ycon=60;
dano=0;
alpha=0;
ultx=x;
ulty=y;
uldir=0;
muerto=0;
datim=0;
danlat=false;
inergolpe=5;
contadan=0;
tocado=true;
diresp=0;
aumengrav=0.25;
conmov=0;
x=global.personajex;
y=global.personajey;
diru=global.diru;
if diru=1{
dir='derecha';}
else{dir='izquierda';}
estado=ej.parado;
global.transi=false;
global.movi=true;
global.xatac=1;
global.yatac=1;
conatac=0;
traspa=false;
instance_create(0,0,menu_pausa);
scape=90;
salidabase=90;
curacion=90;
aterri=0;
anidash=false;
conani=0;
desmur=true;
aterridos=false;
global.puertfade=false;
ojovel=1;
enfria=0;
doble=false;
tocagua=false;
enfriasuelo=0;
activasuelo=0;
enftiem=1;
parche=false;
xant=x;
yant=y;
curando=false;
ahogado=600;
enfriahumo=0;
max_ca=false;
reiniciador=4;
stamina=global.stamina;
enfriacaja=true;
enfriaesc=0;
emparedado=false;
nuram=101;
cayendo=false;
bloqueado=false;
cuenres=0;
cayido=0;
enfriares=0;
dasheado=false;

controldeath = .20
conizqhor = 0
conizqver = 0
conderhor = 0
conderver = 0
vibrar = false
remorido=false

is_water_surface_collision=false
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Constantes
//Gravedad
con_grav=6
//Gravedad en el agua
con_grav_agua=3
//Velocidad del personaje
con_vel=3
//Inercia del personaje
des_iner=0.5
//Aumento de gravedad del personaje
con_aumengrav=0.25
//Aumento de gravedad del personaje en el agua
con_aumengrav_agua=0.1
//Pitch
con_pitch=1
//Pitch en el agua
con_pitch_agua=2/3
//Inercia
con_iner=0
//Vida de aumento
cons_fact=10
//Velocidad de cuerda
vel_cuer=12
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Codigo
if instance_exists(Obj_save){exit}
if !instance_exists(checkpoint){image_blend = make_colour_rgb(irandom(255), irandom(255), irandom(255));}
if (global.pause2) {estado=ej.parado;hsp=0;script_execute(estado);exit}

if !audio_is_playing(global.temax) and dano!=3 {audio_stop_all();audio_play_sound(global.temax,2,true)}
if !audio_is_playing(f_lluvia) and instance_exists(generador_lluvia){audio_play_sound(f_lluvia,1,true)}
if audio_is_playing(f_lluvia) and !instance_exists(generador_lluvia){audio_stop_sound(f_lluvia)}

//Crear a murciegato
if !instance_exists(murciegato_personaje){instance_create(x,y,murciegato_personaje);}


//Vida total
if global.asimilado==true{
global.vida_max=100+global.moneda;}
else{global.vida_max=100}


//Movimiento with Gamepad
//if(gamepad_is_connected(0)) //Used to know if a slot is connected to a game controller
//{
//    gamepad_set_axis_deadzone(0, .1); //Creates a zone where either of the sticks must give a larger value than the deadzone value (.1) otherwise it's interpreted as 0.
    controldeath = .2; //A variable to allow easy manipulation later on

    //These variables will hold the value of the left and right sticks axis.
    conizqhor = gamepad_axis_value(0, gp_axislh);
    conizqver = gamepad_axis_value(0, gp_axislv);
    conderhor = gamepad_axis_value(0, gp_axisrh);
    conderver = gamepad_axis_value(0, gp_axisrv);
//}
if(conizqhor &gt; controldeath)
    {
        pala_izq_hor=1
        con_vel=abs(round(conizqhor*3))
    }
else if(conizqhor &lt; -controldeath)
    {
        pala_izq_hor=-1
        con_vel=abs(round(conizqhor*3))
    }
else{pala_izq_hor=false;con_vel=3}
//Controles
//Botones
boton_salto=keyboard_check(vk_space) or gamepad_button_check(0, gp_face1) or gamepad_button_check(0, gp_shoulderlb)
boton_izq=keyboard_check(ord('A')) or pala_izq_hor=-1
boton_der=keyboard_check(ord('D')) or pala_izq_hor=1

boton_reg=keyboard_check(ord("Q")) or gamepad_button_check(0, gp_start)
boton_cura=keyboard_check(ord("X")) or gamepad_button_check(0, gp_face4)
boton_aba=keyboard_check(ord("S")) or gamepad_button_check(0, gp_padd) or conizqver&gt;0.9

boton_save=keyboard_check_released(ord('R')) or gamepad_button_check_released(0, gp_start)
boton_salida=keyboard_check(vk_escape) or gamepad_button_check(0, gp_select)
boton_P=keyboard_check_pressed(ord('P'))
boton_O=keyboard_check_pressed(ord('O'))

boton_carriba=keyboard_check(vk_up)
boton_cabajo=keyboard_check(vk_down)

//Presionados
press_salto=keyboard_check_pressed(vk_space) or gamepad_button_check_pressed(0, gp_face1) or gamepad_button_check_pressed(0, gp_shoulderlb)
press_dash=keyboard_check_pressed(vk_shift) or gamepad_button_check_pressed(0, gp_shoulderr)
press_C=keyboard_check_pressed(ord('C')) or gamepad_button_check_pressed(0, gp_padr)
press_Z=keyboard_check_pressed(ord('Z')) or gamepad_button_check_pressed(0, gp_padl)
//Despresionados
rele_salto=keyboard_check_released(vk_space) or gamepad_button_check_released(0, gp_face1)  or gamepad_button_check_released(0, gp_shoulderlb)

//Raton
mouse_arriba=mouse_wheel_up()
mouse_abajo=mouse_wheel_down()
mouse_izq=mouse_check_button(mb_left) or gamepad_button_check(0, gp_face3) or gamepad_button_check(0, gp_shoulderrb)
mouse_der=keyboard_check(vk_alt) or gamepad_button_check(0, gp_shoulderl)
mouse_press_izq=mouse_check_button_pressed(mb_left) or gamepad_button_check_pressed(0, gp_face3) or gamepad_button_check_pressed(0, gp_shoulderrb)
mouse_press_der=keyboard_check_pressed(vk_alt) or gamepad_button_check_pressed(0, gp_shoulderl)

//show_debug_message(string(!place_meeting(x,y-32,agua)));
// and global.movi=true
//Regresar
if boton_reg and scape=90 and (global.movi=true or room==Miknokcrin_Boss) and global.hab_regresar=true and instance_exists(checkpoint) and global.pause=false{salidabase=salidabase-1;}
else{salidabase=90}
if salidabase=0
{
    audio_play_sound(f_muerte_bosses,0,0);
    global.escenario=mundo_onirico;
    global.personajex=1920/2;
    global.personajey=1080/2;
    instance_create(x, y, Obj_fade_onirico2);
}

//Reiniciar
if global.carga=true and instance_exists(checkpoint){
    global.vida=global.vida_max;
    x=checkpoint.x;
    y=checkpoint.y;
    Camara.x=x;
    Camara.y=y;
    murciegato_personaje.x=x;
    murciegato_personaje.y=y;
    gamepad_set_vibration(0, 0, 0);
    global.carga=false;
}

if boton_save and file_exists('Save.dat') and ((global.vida &lt;= 0))
{
    global.muertes=global.muertes+1;
    if irandom(global.muertes)&gt;irandom_range(2,8) and global.primera_colztrok=true and global.central=true
    {
        audio_stop_all();
        global.muertes=0;
        global.vida=global.vida_max;
        global.personajex=2144;
        global.personajey=32;
        dano=0;
        muerto=0;
        dash=false;
        hsp=0;
        vsp=0;
        grav=0;
        reiniciador=4;
        global.movi=true;
        image_alpha=1;
        global.central=false;
        room_goto(Central_1);
        ds_map_destroy(global.Collected_Coins);
        global.Collected_Coins=ds_map_secure_load("datos.dat");
        exit;
    }
    room_goto(global.room_id);
    global.carga=true;
    global.objetos_act=global.objetos;
    global.vida=global.vida_max;
    dano=0;
    muerto=0;
    dash=false;
    hsp=0;
    vsp=0;
    grav=0;
    reiniciador=4;
    global.movi=true;
    image_alpha=1;
    ds_map_clear(global.Mapa_Enemigos);
    audio_stop_all();
    game_save("Save.dat");
    audio_stop_all();
    game_load("Save.dat");
    global.movi=true;
    ds_map_destroy(global.Collected_Coins);
    global.Collected_Coins=ds_map_secure_load("datos.dat");
    game_save("Save.dat");
    ds_map_destroy(global.Collected_Coins);
    global.Collected_Coins=ds_map_secure_load("datos.dat");
}
else if boton_P and boton_O and global.vida &gt; 0{global.vida=0;}
else if place_meeting(x,y,bloque_dan_total) and global.vida &gt; 0 {global.vida=0;}

//Salir
if boton_salida and global.pause=false{scape=scape-1;}
else{scape=90}
if scape=0{
    audio_stop_sound(global.temax);
    ds_map_destroy(global.Collected_Coins);
    global.Collected_Coins=ds_map_secure_load("datos.dat");
    game_save("Save.dat");
    room_goto(0);
}

if (global.pause) {image_speed=0;exit}

//Curarse
if boton_cura{curando=true;}
if !boton_cura{curando=false;}
if curando=true and global.movi=true and scape=90 and salidabase=90 and global.objetos_act&gt;0 and (global.vida!=global.vida_max or stamina!=global.stamina) and activasuelo = 1 and enfria=0 and dash=false{hsp=0;iner=0;curacion=curacion-1;if !instance_exists(humo_caida){instance_create(x,y,humo_caida);}}
else{curacion=global.enfria_cura;curando=false;}
if curacion&lt;0{audio_play_sound(f_save,0,false);stamina=global.stamina;curacion=global.enfria_cura;global.objetos_act=global.objetos_act-1;global.vida=global.vida+cons_fact*global.aumen_fac;instance_create(x, y, Obj_cura);enfria=40;global.curarse=false;}


if global.movi=false{image_speed=0;exit}

//Iniciar Movimiento

//OTROS
emparedado=false;
if boton_aba 
{
traspa=true;
}
else{traspa=false;}

//Musica Inicio
if global.primeravez=true{audio_play_sound(global.tema, 0, true);global.primeravez=false;}

if global.movi=true
{

//ATAQUES
//
if !instance_exists(checkpoint) {global.item_ataque=-1}
if !instance_exists(checkpoint) and room=Final_Arena_FIN {global.item_ataque=0}
if (press_C or mouse_abajo) and instance_exists(checkpoint)
{
global.item_ataque=global.item_ataque+1;
if global.item_ataque=0 and global.item_espada=false {global.item_ataque=global.item_ataque+1}
if global.item_ataque=1 and global.item_disparo=false {global.item_ataque=global.item_ataque+1}
if global.item_ataque=2 and global.item_yoyo=false {global.item_ataque=global.item_ataque+1}
if global.item_ataque=3 and global.item_boomerang=false {global.item_ataque=global.item_ataque+1}
if global.item_ataque=4 and global.item_detonadores=false {global.item_ataque=global.item_ataque+1}
if global.item_ataque=5 and global.item_fuego=false {global.item_ataque=global.item_ataque+1}
if global.item_ataque=6 and global.item_misil=false {global.item_ataque=global.item_ataque+1}
if global.item_ataque=7 and global.item_cuerda=false {global.item_ataque=global.item_ataque+1}
if global.item_espada=true{audio_play_sound(f_cambio,0,0);}
}

else if ((press_Z or mouse_arriba) and global.item_espada=true) and instance_exists(checkpoint)
{
global.item_ataque=global.item_ataque-1;
if global.item_ataque&lt;-1{global.item_ataque=global.item_max}
if global.item_ataque=7 and global.item_cuerda=false {global.item_ataque=global.item_ataque-1}
if global.item_ataque=6 and global.item_misil=false {global.item_ataque=global.item_ataque-1}
if global.item_ataque=5 and global.item_fuego=false {global.item_ataque=global.item_ataque-1}
if global.item_ataque=4 and global.item_detonadores=false {global.item_ataque=global.item_ataque-1}
if global.item_ataque=3 and global.item_boomerang=false {global.item_ataque=global.item_ataque-1}
if global.item_ataque=2 and global.item_yoyo=false {global.item_ataque=global.item_ataque-1}
if global.item_ataque=1 and global.item_disparo=false {global.item_ataque=global.item_ataque-1}
if global.item_ataque=0 and global.item_espada=false {global.item_ataque=global.item_ataque-1}
if global.item_espada=true{audio_play_sound(f_cambio,0,0);}
}
if global.item_ataque&gt;global.item_max{global.item_ataque=-1}

//Enfriamientos
if (place_meeting(x,y,agua) and enfria&gt;=40) or !place_meeting(x,y,agua)
{
    if enfria&gt;0 and !(instance_exists(defensa_escudo) and enfria&lt;=10 ){enfria=enfria-1}
}
if enfriaesc&gt;0{enfriaesc=enfriaesc-1}

if !place_meeting(x,y,agua) and curacion=global.enfria_cura and global.vida&gt;0{
//Espada
if mouse_press_izq and enfria=0 and global.item_ataque=0 and global.item_espada=true and stamina&gt;=0 {stamina=stamina-8;instance_create(x,y,ataque_espada);if global.vida&gt;1{global.vida=global.vida-0.5};if global.mejora_espada&lt;2{if enfria&lt;=10{enfria=10}}else{if enfria&lt;=5{enfria=5}}}
if instance_exists(ataque_espada){if global.mejora_espada&lt;2{enfria=15}else{enfria=5}}
//Proyectil
if global.mejora_disparo&lt;2
{
    if mouse_press_izq and enfria=0 and global.item_ataque=1 and global.item_disparo=true and stamina&gt;=0 and global.vida&gt;5{stamina=stamina-10;instance_create(x,y,ataque_proyectil);global.vida=global.vida-5;if enfria&lt;=30{enfria=30}}
}
else
{
    if mouse_izq and enfria=0 and global.item_ataque=1 and global.item_disparo=true and stamina&gt;=0 and global.vida&gt;1{stamina=stamina-2;if stamina&lt;=0 and global.vida&gt;2{stamina=-20};instance_create(x,y,ataque_proyectil);global.vida=global.vida-1;if enfria&lt;=5{enfria=5}}
}
//Yoyo
if mouse_press_izq and enfria=0 and global.item_ataque=2 and !instance_exists(ataque_yoyo) and global.item_yoyo=true and stamina&gt;=0 and global.vida&gt;5{stamina=stamina-10;instance_create(x,y,ataque_yoyo)global.vida=global.vida-5;;if global.mejora_yoyo&lt;2{if enfria&lt;=30{enfria=30}}else{if enfria&lt;=2{enfria=2}}}
if instance_exists(ataque_yoyo){if global.mejora_yoyo&lt;2{if enfria&lt;=30{enfria=30}}else{if enfria&lt;=2{enfria=2}}}
//Boomerang
if mouse_press_izq and (enfria=0 or instance_exists(ataque_boomerang))and global.item_ataque=3 and instance_number(ataque_boomerang)&lt;global.mejora_boomerang and global.item_boomerang=true and stamina&gt;=0 and global.vida&gt;20{stamina=stamina-15;instance_create(x,y,ataque_boomerang);global.vida=global.vida-20;if enfria&lt;=10{enfria=10}}
if instance_exists(ataque_boomerang){if enfria&lt;=10{enfria=10}}
//Detonadores
if mouse_press_izq and enfria=0 and global.item_ataque=4 and !instance_exists(ataque_detonadores) and global.item_detonadores=true and stamina&gt;=0 and global.vida&gt;40{stamina=stamina-20;instance_create(x,y,ataque_detonadores);global.vida=global.vida-40;if enfria&lt;=40{enfria=40}}
if instance_exists(ataque_detonadores){if enfria&lt;=40{enfria=40}}
//Fuego
if mouse_izq and enfria=0 and global.item_ataque=5 and global.item_fuego=true and stamina&gt;=0 and global.vida&gt;4{stamina=stamina-5;instance_create(x,y,ataque_fuego);global.vida=global.vida-4;if global.mejora_fuego&lt;2{if enfria&lt;=35{enfria=35}}else{if enfria&lt;=15{enfria=15}}}
//Misil
if mouse_press_izq and enfria=0 and global.item_ataque=6 and !instance_exists(ataque_misil) and global.item_misil=true and stamina&gt;=0 and global.vida&gt;80{stamina=stamina-10;instance_create(x,y,ataque_misil);global.vida=global.vida-80;if enfria&lt;=30{enfria=30}}
if instance_exists(ataque_misil){if enfria&lt;=30{enfria=30}}
//Cuerda
if mouse_press_izq and tocagua=false and enfria=0 and global.item_ataque=7 and !instance_exists(ataque_cuerda) and !instance_exists(ataque_cuerda_nodan) and global.item_cuerda=true and stamina&gt;=0 and global.vida&gt;40{stamina=stamina-40;instance_create(x,y,ataque_cuerda);global.vida=global.vida-40;if global.hab_cuerdalarga=false{enfria=40}else{enfria=30}}
if instance_exists(ataque_cuerda_nodan){if global.hab_cuerdalarga=false{if enfria&lt;=40{enfria=40}}else{if enfria&lt;30{enfria=30}}}
if instance_exists(ataque_cuerda){if global.hab_cuerdalarga=false{if enfria&lt;=40{enfria=40}}else{if enfria&lt;30{enfria=30}}}
}
else if mouse_press_izq and tocagua=true and global.item_ataque!=-1 and !instance_exists(ataque_detonadores){audio_play_sound(f_error,0,0)}
//Defensa
if mouse_press_der and enfriaesc=0 and global.hab_escudo=true and dash=false and stamina&gt;0 and instance_exists(checkpoint) and global.vida&gt;10{stamina=stamina-5;instance_create(x,y,defensa_escudo);global.vida=global.vida-10;audio_play_sound(f_impacto,0,false)}
if mouse_der and instance_exists(defensa_escudo) 
{
    if global.vida&gt;1{global.vida=global.vida-0.1;}
//    tocagua=true;
    if hsp&gt;1{hsp=1;}
    if hsp&lt;-1{hsp=-1;}
//    if enfria=0{if enfria&lt;=10{enfria=10}}
    if enfria&lt;=10{enfria=10}
    enfriaesc=10
    stamina=stamina-0.1
}


//MOVIMIENTOS
if (dano &lt;1){
//Dash
if press_dash and !press_salto and tocagua=false and !instance_exists(defensa_escudo) and ycon=30 and danlat=false and conatac=0 and global.hab_dash=true and (global.hab_saltodash=true or suelo = 1) and stamina&gt;=0 and max_ca==false{stamina=stamina-10;dash=true;grav=0;ycon=0;anidash=true;audio_play_sound(f_dash,0,0);}
if (dash=true)
{
if (xcon&lt;10){
if dasheado=false{
if (boton_der and boton_izq) {hsp=8*diru;iner=diru*con_vel;dasheado=true}
else if (boton_der){hsp=8;iner=con_vel;dasheado=true;}
else if (boton_izq){hsp=-8;iner=-con_vel;dasheado=true;}
else {hsp=8*diru;iner=diru*con_vel;dasheado=true;}
}
xcon=xcon+1;
if enfria&lt;2{enfria=2}}
else{dasheado=false;dash=false;xcon=0;hsp=con_vel*diru;estcero=false;uldir=0;}
if enfriahumo=0{instance_create(x,y,humo_dash);enfriahumo=2}
if enfriahumo&gt;0{enfriahumo=enfriahumo-1}
}
//Inercia de Movimiento
if dash=false and curacion=global.enfria_cura
{
ycon=ycon+1
if ycon &gt;30 {ycon=30}
if danlat=false and max_ca=false and aterri&lt;=8{
if (boton_der and boton_izq) {iner=iner-des_iner*sign(hsp)}
else if (boton_der) and diresp&gt;=0 {iner=iner+des_iner;estcero=false;}
else if (boton_izq) and diresp&lt;=0{iner=iner-des_iner;estcero=false;}
else {iner=iner-des_iner*sign(hsp);}
if iner&gt;con_vel{iner=con_vel}
if iner&lt;-con_vel{iner=-con_vel}
hsp=round(iner)

if (enfriacaja=false and place_meeting(x+sign(hsp),y,bloque_movil)) or (place_meeting(x+24*sign(hsp),y,bloque_movil) and estado==ej.pared and stamina&lt;=0){hsp=0;iner=0}
if enfriacaja=false and stamina&gt;=10{enfriacaja=true}
}
//Colision Agua
if place_meeting(x,y,agua)
{
    if tocagua=false{tocagua=true;doble=true}
    aumengrav=con_aumengrav_agua;
    enfria=20;
    if (grav&gt;2){grav=2}
    if !(boton_salto=true and global.hab_nado=true and grav&lt;0){
    if hsp&gt;1{hsp=1}
    if hsp&lt;-1{hsp=-1}
    }
    enftiem=2;
    if global.hab_nado=false and ahogado&lt;=0{global.vida=global.vida-0.2}
    if global.hab_nado=false and ahogado&gt;0{ahogado=ahogado-1}
    audio_sound_pitch(global.temax, con_pitch_agua);
    max_ca=false;      
}
else{aumengrav=con_aumengrav;tocagua=false;enftiem=1;ahogado=600;if !position_meeting(x,y+32,agua){audio_sound_pitch(global.temax, con_pitch)}}
}
else{vsp=0}
global.hsp=hsp;

}

//Activar Suelo
if suelo = 1{activasuelo=1;enfriasuelo=4;activasalto=0}
if enfriasuelo&gt;0{enfriasuelo=enfriasuelo-1}
else{activasuelo=0}

//Salto Doble
if (press_salto and tocagua=false and activasuelo=0 and global.movi=true and (doble=true or global.infinito=true) and global.hab_doble=true)
    {
    grav=-con_grav;
    doble=false;
    audio_play_sound(f_salto2,0,0);
    instance_create(x,y,humo_salto);
    }
//Salto en agua
if tocagua=true{
    if press_salto = true and (global.hab_nado=true or activasuelo = 1){grav=-con_grav_agua}
}
    
//Movimiento de Salto
if (press_salto and tocagua=false and activasuelo = 1 and global.movi=true)
    {
    grav=-con_grav;
    vsp=((press_salto))*grav;
    suelo=0;
    enfriasuelo=0;
    activasuelo=0;
    activasalto=1;
    press=true;
    uldir=0;
    audio_play_sound(f_salto2,0,0);
    instance_create(x,y,humo_salto);
    }
else if (rele_salto and grav &lt;0 and dash=false) 
    {grav=round(grav/2);vsp=grav;salto=salto+1;}
else if dash=false{grav=grav+aumengrav;if (grav&gt;20){grav=20};if (grav&gt;14){max_ca=true;iner=0;hsp=0;};vsp=round(grav);}
}


//Movimiento de cuerda
if instance_exists(ataque_cuerda_nodan)=true 
    {
        iner=0;
        vel=vel_cuer;
        vecx=ataque_cuerda_nodan.x-x;
        vecy=ataque_cuerda_nodan.y-y;
        unit=sqrt(sqr(vecx)+sqr(vecy));
        velx=vecx/unit;
        vely=vecy/unit;
        if place_meeting(x,y,ataque_cuerda_nodan) or place_meeting(x,y,agua) or place_meeting(x+1.1*vel*velx,y, bloque_dan) or place_meeting(x+1.1*vel*velx,y,enemigo_base)
        {
        if place_meeting(x+1.1*vel*velx,y,ataque_cuerda_nodan) {grav=-6;}
        instance_destroy(ataque_cuerda_nodan);
        exit
        }
        if place_meeting(x,y,ataque_cuerda_nodan) or place_meeting(x,y,agua) or place_meeting(x,y+1.1*vel*vely, bloque_dan) or place_meeting(x,y+1.1*vel*vely,enemigo_base)
        {
        if place_meeting(x,y+1.1*vel*vely,ataque_cuerda_nodan) {grav=-6;}
        instance_destroy(ataque_cuerda_nodan);
        exit
        }
        hsp=round(vel*velx)
        vsp=round(vel*vely)
        repeat abs(hsp/2)
        {
            if place_meeting(x+sign(hsp),y,bloque) and !place_meeting(x+sign(hsp),y-1, bloque) {y--}
            if place_meeting(x-sign(hsp),y,bloque) and !place_meeting(x-sign(hsp),y+1, bloque) {y++}
            if (!place_meeting(x+sign(hsp),y,bloque)){x+=sign(hsp);desmur=false}
            else if !place_meeting(x,y+vsp,bloque) {desmur=true;anidash=false;break}
        }
        repeat abs(vsp/2)
        {
            if place_meeting(x,y+sign(vsp),bloque) and !place_meeting(x-1,y+sign(vsp), bloque) {x--}
            if place_meeting(x,y-sign(vsp),bloque) and !place_meeting(x+1,y-sign(vsp), bloque) {x++} 
            if (!place_meeting(x,y+sign(vsp),bloque)){y+=sign(vsp);desmur=false}
            else if !place_meeting(x+hsp,y,bloque) {desmur=true;anidash=false;break}
        }
        grav=0;
    }
//Colision Enemigos
//Lateral
script_direct();
if place_meeting(x,y,enemigo_estatico) and hsp=0 and suelo=1{x=x+16*global.direc;}
if dano=0{
if place_meeting(x+hsp,y,enemigo_base) and dash=false
{
    global.vida=global.vida-50;
    stamina=stamina-20;
    if global.hardcore=true{global.vida=0}
    instance_create(x,y,Vibrataque);
    dano=-1;
    datim=50;
    diru=global.direc;
    hsp=diru*inergolpe;
    diru=-diru;
    dash=false;
    estcero=false;
    vsp=0;
    estcero=false;
    danlat=true;
    contadan=10;
    tocado=false;
    grav=-2;
    dandan=true;
    iner=0;
    audio_play_sound(f_danado,0,0);
}
else if place_meeting(x+hsp,y,Jefe_Final) and dash=false
{
    global.vida=global.vida+5;
    dano=-1;
    datim=50;
    diru=global.direc;
    hsp=diru*inergolpe;
    diru=-diru;
    dash=false;
    estcero=false;
    vsp=0;
    estcero=false;
    danlat=true;
    contadan=10;
    tocado=false;
    grav=-2;
    dandan=true;
    audio_play_sound(f_danado,0,0);
}
}
else 
{
if place_meeting(x+hsp,y,enemigo_estatico) and dash=false 
{
    while(!place_meeting(x+sign(hsp),y,enemigo_estatico)) x+=sign(hsp);
    hsp=0;
    desmur=true;
    anidash=false;
}
else {desmur=false;}
}


if contadan&lt;0{danlat=false;contadan=11;hsp=0;tocado=true;}else if contadan&lt;11{contadan=contadan-1;}


//Colision Elementos de Daño
if instance_exists(Obj_fade_escalera)
{
    vsp=0;
    grav=0;
    hsp=0;
    iner=0;
}
if place_meeting(x+hsp,y,bloque_dan)
{
vsp=0;
grav=0;
x=ultx-uldir*24;
y=ulty;
hsp=0;
vsp=0;
dash=false;
estcero=false;
danlat=true;
iner=0;
max_ca=false;
instance_create(x,y,Obj_fade4);

if dano=0
{
    global.vida=global.vida-50;
    instance_create(x,y,Vibrataque);
    stamina=stamina-20;
    dano=-1;
    datim=30;   
}
}

if place_meeting(x,y+vsp,bloque_dan) 
{
vsp=0;
grav=0;
x=ultx-uldir*24;
y=ulty;
hsp=0;
vsp=0;
dash=false;
estcero=false;
danlat=true;
iner=0;
max_ca=false;
instance_create(x,y,Obj_fade4);
if dano=0
{
    global.vida=global.vida-50;
    instance_create(x,y,Vibrataque);
    stamina=stamina-20;
    dano=-1;
    datim=30;
    if global.hardcore=true{global.vida=0}
}
}

if (place_meeting(x+hsp,y,bloque)) and grav&gt;0 and tocagua=false
{
    if sign(hsp)=1{lateral=1;lateraba=true;}
    if sign(hsp)=-1{lateral=-1;lateraba=true;}
    des=0;
    anidash=false; 
    
}
else{des=1;latersig=true;}

//Mueve Bloques
if place_meeting(x+diru*(4),y,bloque_movil) and (hsp&gt;0 or hsp&lt;0)
    {
        conmov=4
    }
if conmov&gt;0{
conmov=conmov-1
}
romper=false;
romper2=false;
//Colisión normal x
repeat abs(hsp)
    {
//Suben
        if !instance_exists(ataque_cuerda_nodan){
        if place_meeting(x+sign(hsp),y,bloque) and place_meeting(x+sign(hsp),y-1, bloque) and place_meeting(x+sign(hsp),y-2, bloque) and !place_meeting(x+sign(hsp),y-3, bloque) {y--;romper=true;romper2=true}
        if place_meeting(x+sign(hsp),y,bloque) and place_meeting(x+sign(hsp),y-1, bloque) and !place_meeting(x+sign(hsp),y-2, bloque) {y--;romper=true}
        else if place_meeting(x+sign(hsp),y,bloque) and !place_meeting(x+sign(hsp),y-1, bloque){y--}
        if place_meeting(x+sign(hsp),y,bloque) and !place_meeting(x+sign(hsp),y+1, bloque) {y++}
        }
//Bajan 
        if !place_meeting(x+sign(hsp),y,bloque) and !place_meeting(x+sign(hsp),y+1,bloque) and place_meeting(x+sign(hsp),y+2,bloque) and dash=false{y++}
//Normal
        if romper=true and place_meeting(x+hsp,y,bloque)
        {
            x+=2*sign(hsp);
        }
        if (!place_meeting(x+sign(hsp),y,bloque)){x+=sign(hsp);desmur=false;}
        else{bloqueado=true;iner=diru*des_iner;desmur=true;anidash=false;break}
        if romper=true{break;}
    }


//Colision plataforma
//Colisión normal y
if !place_meeting(x,y,agua) and place_meeting(x,y+abs(vsp),bloque_goma) and !place_meeting(x,y,bloque_goma){if boton_salto=true{grav=-8;vsp=-8} else {grav=-3;vsp=-3};max_ca=false;audio_play_sound(f_up,1,false)}
if place_meeting(x,y+vsp,bloque) {
    while(!place_meeting(x,y+sign(vsp),bloque)) y+=sign(vsp);
//    iner=iner-des_iner*sign(hsp)
    if sign(vsp)=1
    {
        if suelo=0{aterri=8*enftiem}
        suelo=1;
        salto=0;
        choizq=true;
        choder=true;
        lateral=0;
        press=false;
        ultx=x;
        ulty=y;
        uldir=sign(iner);
        doble=true;
    }
    vsp=0;
    grav=0;
    script_resbalar2();
}
//Colision plataforma_movil
else if !place_meeting(x,y,plataforma) and place_meeting(x,y+vsp,plataforma) and traspa=false
{
    while(!place_meeting(x,y+sign(vsp),plataforma)) y+=sign(vsp);
    if sign(vsp)=1
    {
        if suelo=0{aterri=8}
        suelo=1;
        salto=0;
        choizq=true;
        choder=true;
        lateral=0;
        press=false;
        ultx=x;
        ulty=y;
        uldir=sign(hsp);
        vsp=0;
        grav=0;
        doble=true;
    }
    
}
else if place_meeting(x,y+vsp+1,plataforma_movil) and !place_meeting(x,y-1,plataforma_movil) and traspa=false
    {   
        plataformaN=instance_nearest(x, y, plataforma_movil);
        var protect;
        protect=0;
        if plataformaN.horizontal=true
            {
                repeat abs((vsp+1)/2)
                {
                    if (!place_meeting(x,y+sign(vsp),plataforma_movil)){y+=sign(vsp);}
                }
                x=x+plataformaN.vel*plataformaN.estado;
            }
        else
            {
                y=y+plataformaN.vel*plataformaN.estado;
                while(!place_meeting(x,y+sign(vsp)-(plataformaN.vel)*(plataformaN.estado),plataforma_movil)) {y+=sign(vsp);protect=protect+1;if protect&gt;8{break}}
            }
        if sign(vsp)=1
            {
                if suelo=0{aterri=8}
                suelo=1;
                salto=0;
                choizq=true;
                choder=true;
                lateral=0;
                press=false;
                ultx=x;
                ulty=y;
                uldir=sign(hsp);
                vsp=0;
                grav=0;
                doble=true;
            } 
    }
    
else if !place_meeting(x,y,plataforma_final) and place_meeting(x,y+vsp,plataforma_final)
{
    while(!place_meeting(x,y+sign(vsp),plataforma_final)) y+=sign(vsp);
    if sign(vsp)=1
    {
        if suelo=0{aterri=8}
        suelo=1;
        salto=0;
        choizq=true;
        choder=true;
        lateral=0;
        press=false;
        ultx=x;
        ulty=y;
        uldir=sign(hsp);
        vsp=0;
        grav=0;
        doble=true;
    }
    
}
else {suelo=0;}
if vsp=0{esta=1}
else{esta=0}
if place_meeting(x,y+esta,bloque) {suelo=1}
if esta=1{
if (place_meeting(x,y+esta,plataforma) and !place_meeting(x,y,plataforma)) or (place_meeting(x,y+esta,plataforma_final) and !place_meeting(x,y,plataforma_final)){suelo=1}
}

//Colisión Y
global.vsp=vsp;
y+=vsp;


//Ejecucion
//Prevención de Bugs
if place_meeting(x,y,bloque)
{
if !place_meeting(x-21,y,bloque){x=x-2}
else if !place_meeting(x+21,y,bloque){x=x+2}
else {y=y-1}
}
if instance_exists(obj_salidas_central){
script_salidas_central();}
else{script_salidas();}

//script_resbalar();
//if place_meeting(x,y,obj_trampa){instance_create(x,y,bloque_dan_total)}
//if place_meeting(x,y,personaje) and !place_meeting(x,y,bloque_dan_mini) 
//{
//    instance_create(x,y,bloque_dan_mini);
//}

//Muerte
if (global.vida &lt;= 0 and muerto=0) {dano=2}
if global.vida&gt;global.vida_max{global.vida=global.vida_max}
if dano=2
{
global.onirico=false;
audio_stop_all();
audio_play_sound(derrota_tema, 0, false);
nuram=irandom_range(1,global.recupera+1);
if !instance_exists(enemigo_personaje) and global.primera_colztrok=true and nuram==global.recupera+1 and instance_exists(checkpoint){instance_create(x,y,enemigo_personaje);}
muerto=1;
dano=3;
estado=ej.morido;
xspr=0;
image_index=0;
global.movi=false;
instance_create(x-16,y-16,obj_desintegra);
image_alpha=0;
script_souls();
}


//Ejecución de estados
if dano&lt;1 
{
if(hsp&gt;0) and tocado=true {dir="derecha";diru=1}
else if(hsp&lt;0) and tocado=true{dir="izquierda";diru=-1}
if(dir!=0 and activasuelo=1 and aterri =0) {estado=ej.caminando;anidash=0;pupupa=4;}
if(hsp==0 and activasuelo=1 and dandan =false) {estado=ej.parado;anidash=false;}
else if(hsp==0 and dandan=true) 
    {
        estado=ej.parado;anidash=false;
        if dir ="derecha" {diru=1}
        else if dir ="izquierda"{diru=-1}
        dandan=false;
    }

if (activasuelo=0 and grav&lt;3) {if diru=1{dir="derecha"}else{dir="izquierda"};estado=ej.saltado;pupupa=0;}

if cayido=true{enfriares=6;}
if aterri=0{cayido=false}
//if aterri=0{cayido=false}
if max_ca=true and aterri=8{aterri=30;max_ca=false}
if (des=0 and grav&lt;=0){hsp=0;}
if (desmur=true and suelo=1 and romper=false){if diru=1{dir="derecha"}else{dir="izquierda"};estado=ej.parado;hsp=0;}
if boton_cabajo{estado=ej.caido;}
if boton_carriba{estado=ej.caido;}
if (suelo=0 and grav&gt;=3) {if diru=1{dir="derecha"}else{dir="izquierda"};estado=ej.cayendo;anidash=false;}
if (aterri&gt;0 and hsp=0){if aterri==30{script_temblor();stamina=stamina-30;if enfria==0{enfria=40}};aterri=aterri-1; estado=ej.caido;if !instance_exists(humo_caida){if !place_meeting(x,y,agua){instance_create(x,y,humo_caida);}}}
if (curacion&lt;global.enfria_cura){estado=ej.caido;}
if (aterri&gt;0 and hsp!=0){max_ca=0;aterri=0; estado=ej.caminando;pupupa=10;}
if grav&lt;0 {anidash=0}
if (anidash=true or dash=true) and grav &gt;=0 {estado=ej.dash;}
if conmov&gt;0 and suelo=1 and place_meeting(x+24*diru,y,bloque_movil){if diru=1{dir="derecha"}else{dir="izquierda"}estado=ej.pared};
if (conatac&gt;11){estado=ej.espadazo}
}
conatac=conatac-1
if conatac&lt;0{conatac=0}
if dano=-1{
datim=datim-1;
if datim &lt;0 {dano=0;image_alpha=1;danlat=false}
}
if (enfriares&gt;0){estado=ej.caido;enfriares=enfriares-1}
else{cayendo=false}
if place_meeting(x,y,agua) and boton_salto=true and global.hab_nado=true and grav&lt;0{estado=ej.dash}
if (global.entrado=true){estado=ej.parado;}
script_execute(estado);
global.diru=diru;
xant=x;
yant=y;

//Recuperacion de stamina
if enfria==0 and !place_meeting(x,y,agua) and emparedado=false
{
    if stamina&lt;global.stamina{stamina=stamina+global.regeneracion}
}
if stamina&lt;-20{stamina=-20}

if global.bolas&gt;=1 and !instance_exists(acertijo_bola_1){instance_create(x,y,acertijo_bola_1)}
if global.bolas&lt;=3 and global.bolas&gt;=2 and !instance_exists(acertijo_bola_2){instance_create(x,y,acertijo_bola_2)}
if global.bolas=3 and !instance_exists(acertijo_bola_3){instance_create(x,y,acertijo_bola_3)}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Awa de uwu
if !(global.pause or global.pause2) draw_self();

//Lo demás
draw_set_halign(fa_left);
draw_set_valign(fa_center);


if dano&gt;1
{
if alpha &lt; 1 alpha+=0.02;

}
if dano=-1{image_alpha=0.5;}

draw_set_color(c_white);
//draw_set_halign(fa_left);draw_set_valign(fa_center);draw_text(view_xview+8,view_yview+view_hview-16,'Dato: '+string(floor(100*(1/(global.recupera+1))))+'%')
//if instance_exists(acertijo_bola_1){
//draw_set_halign(fa_left);draw_set_valign(fa_center);draw_text(view_xview+80,view_yview+view_hview-16,'Dato: '+string(mouse_x)+"   "+string(mouse_y))
//draw_set_halign(fa_left);draw_set_valign(fa_center);draw_text(view_xview+180,view_yview+view_hview-16,'Dato: '+string(global.tel_encordia_2))
//draw_set_halign(fa_left);draw_set_valign(fa_center);draw_text(view_xview+80,view_yview+view_hview-16,'Dato: '+string(global.onirico))
//draw_set_halign(fa_left);draw_set_valign(fa_center);draw_text(view_xview+200,view_yview+view_hview-16,'Dato: '+string(Destruible_Bola1.x))
//}

//show_debug_message(string(x)+"   "+string(y));
   
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
